---
phase: 01-foundation-text-selection
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - wxt.config.ts
  - tsconfig.json
  - src/entrypoints/popup/index.html
  - src/entrypoints/popup/App.tsx
  - src/entrypoints/popup/main.tsx
  - public/manifest.json
autonomous: true
requirements:
  - EXTF-01
  - EXTF-04

must_haves:
  truths:
    - "WXT project builds without errors via `npm run build`"
    - "manifest.json declares Manifest V3 with correct permissions (storage, runtime)"
    - "manifest.json includes host_permissions with placeholder backend URL"
    - "Extension can be loaded into Chrome via chrome://extensions without CSP errors"
    - "Extension passes Chrome Web Store single-purpose policy (AI text simplification)"
  artifacts:
    - path: "package.json"
      provides: "WXT + React 18 + TypeScript project dependencies"
      contains: "wxt"
    - path: "wxt.config.ts"
      provides: "WXT configuration with MV3 target"
      contains: "manifest"
    - path: "public/manifest.json"
      provides: "Manifest V3 with permissions, host_permissions, CSP"
      contains: "manifest_version"
  key_links:
    - from: "wxt.config.ts"
      to: "public/manifest.json"
      via: "WXT manifest merge"
      pattern: "manifest"
    - from: "public/manifest.json"
      to: "https://api.simplify.example.com/*"
      via: "host_permissions"
      pattern: "host_permissions"
---

<objective>
Scaffold the Twelveify Chrome Extension using WXT with React 18 and TypeScript. Configure Manifest V3 with correct CSP, permissions, and a placeholder backend domain in host_permissions. This creates the entire project foundation all subsequent plans build on.

Purpose: Every Phase 1 feature requires a working WXT project with correct MV3 structure. Getting manifest and CSP right here prevents silent failures in Phase 2.
Output: Buildable WXT project with passing `npm run build`, loadable in Chrome without errors.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-text-selection/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold WXT project with React 18 and TypeScript</name>
  <files>
    package.json
    wxt.config.ts
    tsconfig.json
    src/entrypoints/popup/index.html
    src/entrypoints/popup/App.tsx
    src/entrypoints/popup/main.tsx
  </files>
  <action>
    Run `npm create wxt@latest . -- --template react-ts` in the project root at /Users/brunocampos/Twelvify to scaffold the WXT project with React 18 and TypeScript. If prompted for project name use "twelvify". Accept all defaults.

    After scaffolding:
    1. Verify package.json has `wxt`, `react`, `react-dom`, `typescript` as dependencies
    2. Verify wxt.config.ts exists and targets `chrome` browser
    3. Verify tsconfig.json includes strict mode
    4. Remove any example/demo content from popup/App.tsx — replace with a minimal placeholder: a div with text "Twelveify" and a p tag "Select text on any webpage to simplify it."
    5. Do NOT add Tailwind CSS — deferred to Phase 3

    The WXT scaffold creates src/entrypoints/popup/ (popup page), and will create background/content entrypoints in subsequent plans. Do not create background.ts or content.ts here — those are Plan 02 and 03 respectively.
  </action>
  <verify>
    Run `npm run build` from /Users/brunocampos/Twelvify. Build must complete without errors. Output should be in `.output/chrome-mv3/` directory.
  </verify>
  <done>
    `npm run build` exits 0, `.output/chrome-mv3/` directory exists with manifest.json inside, popup entrypoint included in build output.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Manifest V3 with permissions, CSP, and host_permissions</name>
  <files>
    wxt.config.ts
  </files>
  <action>
    Configure the manifest via wxt.config.ts (WXT merges this with generated manifest). Add the following manifest configuration to wxt.config.ts:

    ```typescript
    import { defineConfig } from 'wxt';

    export default defineConfig({
      extensionEntrypoints: {},
      manifest: {
        name: 'Twelveify',
        description: 'Simplify any text on the web with AI',
        version: '0.1.0',
        permissions: ['storage'],
        host_permissions: [
          'https://api.simplify.example.com/*'
        ],
        content_security_policy: {
          extension_pages: "script-src 'self'; object-src 'self';"
        },
        action: {
          default_title: 'Twelveify'
        }
      }
    });
    ```

    Key requirements:
    - permissions: ONLY 'storage' — do NOT add 'tabs', 'activeTab', 'webRequest' or any other permissions not needed for Phase 1 (principle of least privilege per EXTF-04)
    - host_permissions: placeholder backend URL `https://api.simplify.example.com/*` — Phase 2 will update to real Cloudflare Workers URL
    - CSP: `script-src 'self'; object-src 'self';` — forbids inline scripts, enforces MV3 CSP minimum
    - NO 'nativeMessaging', 'debugger', 'history', or other sensitive permissions (Chrome Web Store flags these for review)
    - Do NOT add `"<all_urls>"` to permissions — only host_permissions for backend; content scripts get their own host access declared separately

    After updating wxt.config.ts, run `npm run build` again and verify `.output/chrome-mv3/manifest.json` contains all the above fields correctly merged.
  </action>
  <verify>
    1. Run `npm run build` — exits 0
    2. Run `cat /Users/brunocampos/Twelvify/.output/chrome-mv3/manifest.json` — verify manifest_version is 3, permissions array contains only "storage", host_permissions contains the placeholder URL, content_security_policy is present
    3. Check that no dangerous permissions (tabs, activeTab, webRequest, nativeMessaging) appear in the output manifest
  </verify>
  <done>
    Built manifest.json shows: manifest_version=3, permissions=["storage"], host_permissions=["https://api.simplify.example.com/*"], content_security_policy present with self-only script-src. Extension loads in Chrome (chrome://extensions → Load unpacked → .output/chrome-mv3/) without errors or warnings in the Extensions page.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` from project root exits 0 with no TypeScript errors
2. `.output/chrome-mv3/manifest.json` exists and validates against MV3 schema (manifest_version: 3)
3. Manifest permissions are minimal — only "storage" in permissions array
4. host_permissions includes placeholder backend URL
5. CSP is present and forbids inline scripts
6. Extension loads in Chrome without CSP or permission errors
</verification>

<success_criteria>
- WXT project scaffolded with React 18 + TypeScript
- `npm run build` passes cleanly
- Manifest V3 configured with correct minimal permissions
- Extension loadable in Chrome developer mode without errors
- Foundation ready for Plan 02 (service worker) and Plan 03 (content script) to build on
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-text-selection/01-01-SUMMARY.md`
</output>
