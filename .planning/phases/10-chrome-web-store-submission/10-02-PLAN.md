---
phase: 10-chrome-web-store-submission
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/assets/icons/icon.svg
  - src/assets/icons/icon16.png
  - src/assets/icons/icon32.png
  - src/assets/icons/icon48.png
  - src/assets/icons/icon128.png
  - wxt.config.ts
autonomous: true
requirements:
  - STOR-02

must_haves:
  truths:
    - "Extension icon displays at 16, 32, 48, and 128px as recognizable PNG files"
    - "Icon uses brand color #f56060 as background fill (sharp square, no rounded corners)"
    - "Icon shows a bold T lettermark in white, flat/minimal style"
    - "wxt.config.ts declares all 4 icon sizes"
    - "Built manifest.json references all 4 icon paths"
  artifacts:
    - path: "src/assets/icons/icon.svg"
      provides: "SVG source vector for all icon sizes"
      contains: "rect fill=\"#f56060\""
    - path: "src/assets/icons/icon128.png"
      provides: "128x128px PNG icon for Web Store listing"
    - path: "src/assets/icons/icon48.png"
      provides: "48x48px PNG icon for Extensions management page"
    - path: "src/assets/icons/icon32.png"
      provides: "32x32px PNG icon for Windows system UI"
    - path: "src/assets/icons/icon16.png"
      provides: "16x16px PNG icon for extension pages favicon"
    - path: "wxt.config.ts"
      provides: "Manifest icons declaration"
      contains: "icons"
  key_links:
    - from: "wxt.config.ts"
      to: "src/assets/icons/icon*.png"
      via: "manifest icons field"
      pattern: "icons.*icon"
---

<objective>
Create the Twelvify brand icon as an SVG source and export to all 4 required PNG sizes (16, 32, 48, 128px). Update the WXT manifest to declare all icon sizes.

Purpose: Chrome Web Store requires icons at 16, 32, 48, and 128px PNG. The 128px icon is used for the store listing and installation dialog. The 48px is used on the extensions management page. Currently no icons exist in the extension.

Output: 4 PNG icon files in `src/assets/icons/`, an SVG source, and updated manifest declaration. Extension will show the branded T lettermark at all required sizes.
</objective>

<execution_context>
@./.claire/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@wxt.config.ts
@landing/tailwind.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create icon SVG and generate PNG exports</name>
  <files>
    src/assets/icons/icon.svg
    src/assets/icons/icon16.png
    src/assets/icons/icon32.png
    src/assets/icons/icon48.png
    src/assets/icons/icon128.png
  </files>
  <action>
**Step 1 — Create directory:**
```bash
mkdir -p src/assets/icons
```

**Step 2 — Create `src/assets/icons/icon.svg`:**
Design spec from user decisions:
- Stylized "T" lettermark — plain, no embellishments
- Sharp-square background (not rounded, not circle)
- Brand color #f56060 fill for background
- Flat/minimal style — no gradients or shadows
- White T lettermark, matching Permanent Marker font aesthetic
- The T should be bold, centered, and legible at 16px

Since web fonts (Permanent Marker) are not guaranteed in SVG renderers, use geometric letterform instead — a clean bold "T" built from two rectangles (horizontal bar + vertical stem). This approach ensures 100% consistent rendering at all sizes without font loading.

```svg
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128">
  <!-- Sharp square background: #f56060 brand color, no rounded corners -->
  <rect width="128" height="128" fill="#f56060"/>

  <!-- Bold T lettermark: two rectangles (horizontal top bar + vertical stem) -->
  <!-- Horizontal bar: full width minus margins, positioned at top 1/4 -->
  <rect x="20" y="22" width="88" height="22" fill="white"/>
  <!-- Vertical stem: centered, from top bar down to bottom margin -->
  <rect x="53" y="44" width="22" height="62" fill="white"/>
</svg>
```

Proportions rationale:
- At 128px: T is 88px wide (top bar), 22px height for bar, 22px wide stem → bold and clear
- At 16px: bar becomes 11px wide, 3px height — still recognizable as T shape
- No serifs or decorations — pure geometric form for maximum legibility at small sizes

**Step 3 — Generate PNG exports using sharp-cli via npx:**
```bash
# 128px — primary Web Store icon
npx --yes sharp-cli -i src/assets/icons/icon.svg -o src/assets/icons/icon128.png resize 128 128

# 48px — Extensions management page
npx --yes sharp-cli -i src/assets/icons/icon.svg -o src/assets/icons/icon48.png resize 48 48

# 32px — Windows system UI
npx --yes sharp-cli -i src/assets/icons/icon.svg -o src/assets/icons/icon32.png resize 32 32

# 16px — Extension pages favicon
npx --yes sharp-cli -i src/assets/icons/icon.svg -o src/assets/icons/icon16.png resize 16 16
```

If `sharp-cli` fails with SVG input (requires libvips with SVG support), fall back to a Node.js script approach:

**Fallback: Create `scripts/generate-icons.mjs`:**
```js
// Uses sharp installed temporarily
import { execSync } from 'child_process'
import { writeFileSync, readFileSync } from 'fs'

// Install sharp temporarily if needed
try { require('sharp') } catch { execSync('npm install --no-save sharp', { cwd: process.cwd() }) }

const sharp = require('sharp')
const svg = readFileSync('src/assets/icons/icon.svg')
const sizes = [16, 32, 48, 128]
for (const size of sizes) {
  await sharp(svg).resize(size, size).png().toFile(`src/assets/icons/icon${size}.png`)
  console.log(`Generated icon${size}.png`)
}
```

**Alternative fallback: Pure Canvas-based Node.js script (no dependencies):**
If sharp also fails, create `scripts/generate-icons.mjs` that generates PNG files from scratch using raw PNG byte sequences (no external dependencies). A 128x128 solid-color PNG with white rectangles can be created programmatically using Node's Buffer and the PNG file format spec.

The PNG approach:
1. Create raw RGBA pixel buffers (128x128, 48x48, 32x32, 16x16)
2. Fill with #f56060 (245, 96, 96, 255) background
3. Draw white pixels for T shape proportional to each size
4. Encode as PNG using the `pngjs` package (or raw Buffer + zlib for zero-dependency)

Use the `pngjs` package (install --no-save):
```bash
npm install --no-save pngjs
node scripts/generate-icons.mjs
```

Script structure:
```js
import { PNG } from 'pngjs'
import { writeFileSync } from 'fs'

function generateIcon(size) {
  const png = new PNG({ width: size, height: size })
  // Fill background #f56060 = rgb(245, 96, 96)
  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      const idx = (y * size + x) * 4
      png.data[idx] = 245    // R
      png.data[idx + 1] = 96  // G
      png.data[idx + 2] = 96  // B
      png.data[idx + 3] = 255 // A
    }
  }

  // Draw T lettermark proportionally
  const margin = Math.round(size * 0.15)
  const barThick = Math.max(2, Math.round(size * 0.17))
  const stemWidth = Math.max(2, Math.round(size * 0.17))
  const stemX = Math.round((size - stemWidth) / 2)

  // Horizontal bar (top)
  for (let y = margin; y < margin + barThick; y++) {
    for (let x = margin; x < size - margin; x++) {
      const idx = (y * size + x) * 4
      png.data[idx] = 255; png.data[idx+1] = 255; png.data[idx+2] = 255; png.data[idx+3] = 255
    }
  }
  // Vertical stem (centered)
  for (let y = margin; y < size - margin; y++) {
    for (let x = stemX; x < stemX + stemWidth; x++) {
      const idx = (y * size + x) * 4
      png.data[idx] = 255; png.data[idx+1] = 255; png.data[idx+2] = 255; png.data[idx+3] = 255
    }
  }

  return PNG.sync.write(png)
}

for (const size of [16, 32, 48, 128]) {
  writeFileSync(`src/assets/icons/icon${size}.png`, generateIcon(size))
  console.log(`Generated icon${size}.png (${size}x${size})`)
}
```

**Execution order:**
1. Try `npx sharp-cli` first (fastest)
2. If sharp-cli fails, try `node scripts/generate-icons.mjs` with pngjs
3. Verify all 4 PNG files exist after whichever method works

After generation, verify file sizes are reasonable:
- icon128.png: should be ~1-5KB
- icon16.png: should be ~100-500B
  </action>
  <verify>
    ls -la src/assets/icons/
    # Expect: icon.svg, icon16.png, icon32.png, icon48.png, icon128.png
    file src/assets/icons/icon128.png
    # Expect: PNG image data, 128 x 128
    file src/assets/icons/icon16.png
    # Expect: PNG image data, 16 x 16
  </verify>
  <done>
    All 5 files exist in src/assets/icons/: icon.svg, icon16.png, icon32.png, icon48.png, icon128.png. Each PNG file verified as valid PNG at correct dimensions. icon.svg contains the T lettermark on #f56060 background.
  </done>
</task>

<task type="auto">
  <name>Task 2: Declare icons in WXT manifest config</name>
  <files>
    wxt.config.ts
  </files>
  <action>
Update `wxt.config.ts` to add an `icons` field to the manifest declaration.

Current wxt.config.ts has `action: { default_title: 'Twelveify' }`. Add the icons field:

```ts
manifest: {
  name: 'Twelveify',
  // ... existing fields ...
  icons: {
    '16': 'assets/icons/icon16.png',
    '32': 'assets/icons/icon32.png',
    '48': 'assets/icons/icon48.png',
    '128': 'assets/icons/icon128.png',
  },
  action: {
    default_title: 'Twelveify',
    default_icon: {
      '16': 'assets/icons/icon16.png',
      '32': 'assets/icons/icon32.png',
      '48': 'assets/icons/icon48.png',
      '128': 'assets/icons/icon128.png',
    },
  },
  // ... rest of existing fields unchanged ...
}
```

Note: WXT copies `src/assets/` to the build output as `assets/`. So the path in manifest should be `assets/icons/icon*.png` (without `src/` prefix). Verify this matches WXT's asset handling by checking the existing .output/chrome-mv3/manifest.json after build — the icons paths should resolve correctly.

Do NOT change any other fields (name, version, permissions, host_permissions, CSP, commands, background, content_scripts).
  </action>
  <verify>
    npm run build 2>&1 | tail -10
    # Expect: Build succeeds
    cat .output/chrome-mv3/manifest.json | python3 -m json.tool | grep -A 10 '"icons"'
    # Expect: icons field with 4 sizes
    ls .output/chrome-mv3/assets/icons/
    # Expect: icon16.png, icon32.png, icon48.png, icon128.png present in build output
  </verify>
  <done>
    `npm run build` succeeds. Built manifest.json at `.output/chrome-mv3/manifest.json` contains `"icons"` field with all 4 sizes. PNG files appear in `.output/chrome-mv3/assets/icons/`. Extension toolbar will display the branded T icon.
  </done>
</task>

</tasks>

<verification>
1. `ls src/assets/icons/` — all 5 files (svg + 4 pngs) present
2. `file src/assets/icons/icon128.png` — PNG image data, 128 x 128
3. `file src/assets/icons/icon16.png` — PNG image data, 16 x 16
4. `npm run build` — succeeds without errors
5. `cat .output/chrome-mv3/manifest.json | python3 -m json.tool` — icons field present with 4 sizes
6. `ls .output/chrome-mv3/assets/icons/` — 4 PNG files in build output
</verification>

<success_criteria>
- SVG source `src/assets/icons/icon.svg` exists with #f56060 background and white T lettermark
- 4 PNG files at 16, 32, 48, 128px exist in `src/assets/icons/`
- All PNGs are valid (file command confirms dimensions)
- wxt.config.ts declares icons in manifest and action
- Extension build succeeds and manifest includes icon paths
</success_criteria>

<output>
After completion, create `.planning/phases/10-chrome-web-store-submission/10-02-SUMMARY.md`
</output>
