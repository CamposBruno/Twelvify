---
phase: 07-launch
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - landing/src/analytics.ts
  - landing/src/main.tsx
  - landing/src/components/Nav.tsx
  - landing/src/components/Hero.tsx
  - landing/src/components/CallToAction.tsx
autonomous: true
requirements:
  - ANALYTICS-01

must_haves:
  truths:
    - "Page views are tracked automatically on every visit"
    - "Clicking any 'Add to Chrome' CTA button fires a tracked event"
    - "Analytics script loads without blocking page render"
  artifacts:
    - path: "landing/src/analytics.ts"
      provides: "Typed analytics helper with trackPageView and trackEvent functions"
      exports: ["trackPageView", "trackEvent"]
    - path: "landing/src/main.tsx"
      provides: "Initialises analytics on app mount"
      contains: "trackPageView"
    - path: "landing/src/components/Nav.tsx"
      provides: "Nav CTA fires trackEvent on click"
      contains: "trackEvent"
    - path: "landing/src/components/Hero.tsx"
      provides: "Hero install CTA fires trackEvent on click"
      contains: "trackEvent"
    - path: "landing/src/components/CallToAction.tsx"
      provides: "CTA section install button fires trackEvent on click"
      contains: "trackEvent"
  key_links:
    - from: "landing/src/main.tsx"
      to: "landing/src/analytics.ts"
      via: "import and call trackPageView on mount"
      pattern: "trackPageView"
    - from: "landing/src/components/Nav.tsx"
      to: "landing/src/analytics.ts"
      via: "onClick handler calling trackEvent"
      pattern: "trackEvent.*cta_click"
---

<objective>
Add lightweight analytics to the landing page — page view tracking and CTA click events — so that visit and install intent data is available from day one after launch.

Purpose: Understand traffic volume and which CTA placements drive Chrome Web Store visits.
Output: analytics.ts helper + instrumented components (Nav, Hero, CTA section).
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create analytics helper and choose provider</name>
  <files>landing/src/analytics.ts</files>
  <action>
Use **Plausible Analytics** — lightweight (~1KB), privacy-first, no cookie consent banner required, free plan available at plausible.io. This is Claude's discretion per CONTEXT.md.

Create `landing/src/analytics.ts` with:

```typescript
// Analytics helper — Plausible script injected via index.html (see Task 2)
// Plausible exposes window.plausible for custom events.

declare global {
  interface Window {
    plausible?: (event: string, options?: { props?: Record<string, string> }) => void;
  }
}

export function trackPageView(): void {
  // Plausible auto-tracks page views when the script loads.
  // This function exists as a hook for future SPA-style navigation tracking.
  // For now it is a no-op — Plausible handles initial page view automatically.
}

export function trackEvent(
  eventName: string,
  props?: Record<string, string>
): void {
  if (typeof window !== 'undefined' && typeof window.plausible === 'function') {
    window.plausible(eventName, props ? { props } : undefined);
  }
}
```

The Plausible script tag will be added to `index.html` in Task 2 (not injected via JS — Plausible requires a `<script>` tag with `data-domain` attribute).

DO NOT add npm package `plausible-tracker` — use the lightweight CDN script approach instead; it requires zero bundle overhead.
  </action>
  <verify>TypeScript compiles: `cd landing && npx tsc --noEmit`</verify>
  <done>landing/src/analytics.ts exports trackPageView and trackEvent with no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: Inject Plausible script + instrument CTA click events</name>
  <files>
    landing/index.html
    landing/src/main.tsx
    landing/src/components/Nav.tsx
    landing/src/components/Hero.tsx
    landing/src/components/CallToAction.tsx
  </files>
  <action>
**Step A — Add Plausible script to index.html:**

In `landing/index.html`, add the Plausible script tag inside `<head>` after the existing font preconnect tags. Use `data-domain="twelvify.com"` and `defer` to avoid render blocking:

```html
<!-- Plausible Analytics — privacy-first, no cookie consent required -->
<script defer data-domain="twelvify.com" src="https://plausible.io/js/script.js"></script>
```

**Step B — Call trackPageView in main.tsx:**

In `landing/src/main.tsx`, import `trackPageView` from `./analytics` and call it once after React renders (wrap in `setTimeout(() => trackPageView(), 0)` to ensure the DOM is ready). This acts as a no-op now but is the hook for SPA tracking later.

```typescript
import { trackPageView } from './analytics';
// ... existing imports ...

// After ReactDOM.createRoot(...).render(...)
setTimeout(() => trackPageView(), 0);
```

**Step C — Instrument CTA buttons:**

In each component, import `trackEvent` from `'../analytics'` (or `'./analytics'` from main.tsx) and add `onClick` handlers to "Add to Chrome" / install buttons.

Event name convention: `'cta_click'`
Props: `{ location: 'nav' | 'hero' | 'cta_section' }`

- `landing/src/components/Nav.tsx` — find the "Add to Chrome" anchor/button → add `onClick={() => trackEvent('cta_click', { location: 'nav' })}` to the element. Do NOT prevent default — the link should still navigate to CHROME_STORE_URL.
- `landing/src/components/Hero.tsx` — find the primary install CTA → add `onClick={() => trackEvent('cta_click', { location: 'hero' })}`.
- `landing/src/components/CallToAction.tsx` — find the install CTA → add `onClick={() => trackEvent('cta_click', { location: 'cta_section' })}`.

Read each file first to identify the exact element before editing.
  </action>
  <verify>
1. `cd landing && npm run build` completes with no errors
2. `cd landing && npx tsc --noEmit` passes
3. Grep confirms event calls: `grep -r "trackEvent" landing/src/components/`
4. Grep confirms script tag: `grep "plausible" landing/index.html`
  </verify>
  <done>
- Plausible script tag present in index.html with data-domain="twelvify.com" and defer
- trackEvent('cta_click') called in Nav, Hero, and CallToAction components
- Build succeeds with no TypeScript or bundle errors
  </done>
</task>

</tasks>

<verification>
Run `cd landing && npm run build` — must complete successfully.
Run `cd landing && npx tsc --noEmit` — zero errors.
Run `grep -r "cta_click" landing/src/` — must show matches in Nav.tsx, Hero.tsx, CallToAction.tsx.
Run `grep "plausible.io" landing/index.html` — script tag present.
</verification>

<success_criteria>
Analytics is wired: Plausible script loads deferred on every page visit (auto page-view), and each of the three CTA placements fires a named 'cta_click' event with a location prop when clicked. Build is clean.
</success_criteria>

<output>
After completion, create `.planning/phases/07-launch/07-01-SUMMARY.md` following the summary template.
</output>
